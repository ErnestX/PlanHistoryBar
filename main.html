<!DOCTYPE html>
<!--http://www.kirupa.com/html5/creating_a_sweet_content_slider.htm-->
<html>
<head>
    <script src="jquery-1.11.3.js"></script>
    <script src="uiHelpers.js"></script>
    <script>$(document).ready(function(){
    
        var activePhotoIndex = 4;
        var rangeLeft = 0;
        var rangeRight = 9;

        var i;
        for (i=rangeLeft; i < rangeRight; i++) {
            var img = getPlanAtIndex(i);
            initPlan(img);
            $("#bar").append(img);
        }
        
        selectIndex(activePhotoIndex);
        
        $("#left").click(function(){
            // perform selection
            activePhotoIndex--;
            selectIndex(activePhotoIndex);
                
            $("#bar").addClass("rightShiftting");
            $("#bar").one('webkitAnimationEnd oanimationend msAnimationEnd animationend', function(e) {
            
                // add new plan at left
                var newImg = getPlanAtIndex(rangeLeft - 1);
                initPlan(newImg);
                $("#bar").prepend(newImg);
                rangeLeft--;
            
                // delete plan at right
                $("#bar").children().last().remove();
                rangeRight--;
                
                $("#bar").removeClass("rightShiftting");
            });
        });
        
        $("#right").click(function() {
            // perform selecttion
            activePhotoIndex++;
            selectIndex(activePhotoIndex);
            
            $("#bar").addClass("leftShiftting");
            $("#bar").one('webkitAnimationEnd oanimationend msAnimationEnd animationend', function(e) {
                // delete plan at left
                $("#bar").children().eq(0).remove();
                rangeLeft++;
            
                // add new plan plan at right
                var newImg = getPlanAtIndex(rangeRight + 1);
                initPlan(newImg);
                $("#bar").append(newImg);
                rangeRight++;
                
                $("#bar").removeClass("leftShiftting");
            });

        });
        
        function selectIndex(planIndex) {
            $("#bar").children().removeClass("selected");
            $("#bar").children().addClass("unselected");
            
            $("#bar").children().eq(planIndex - rangeLeft).removeClass("unselected");
            $("#bar").children().eq(planIndex - rangeLeft).addClass("selected");
            
            console.log("select #" + planIndex.toString());
        }
    });
    </script>
    <link rel=stylesheet href="style.css">
</head>

<body>
    <div id="barContainer"> 
        <div id="bar"></div>
<!--        <div id="charts"></div>-->
    </div>
    <div id="detailView"></div>
    
    <p>
        <button id="left">left</button>
        <button id="right">right</button>
    </p>
    <p>
        <button id="lastPage">last page</button>
        <button id="nextPage">next page</button>
    </p>
</body>
</html>